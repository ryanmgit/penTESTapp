import requests
import re
from ares import CVESearch

# open client list
clientlist = open(r"/path/to/clientlist.txt", "r")

#initialize variables
n=0
versioned_servers = {}

while(True):
    # Read a line.
    line = clientlist.readline()
    # when readline returns an empty string finish reading
    if line == "":
        print("::DONE::")
        break
        
    url = line.strip()
    
    #iterate client number
    n = int(n)
    n += 1
    n = str(n)
    
    #print client info
    print("::Client ",  n, "::", sep='')
    print(url)
    
    # fetch the content from url
    page_html = requests.get(url, timeout=5)
    
    header = page_html.headers
    
    #narrow scope to servers 
    if "server" in header:
        print("Server:", header["server"])
        
        #find servers that display version numbers
        version = re.search(r'\d+$', header["server"])
        if version is not None:  
            versioned_servers["client" + n] = header["server"]
    else:
        print("no server information")

#print the versioned servers
print("\nCaution the following servers are broadcasting their versions\n") 
for k in versioned_servers:
    print(k, ": ", versioned_servers[k], sep="")